<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subir Documentos</title>
    <meta name="description" content="Página para subir documentos y credenciales de forma segura.">
    <meta name="keywords" content="subir documentos, credenciales, seguridad, upload">
    <meta name="author" content="Tu Nombre o Empresa">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <!-- SweetAlert2 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <!-- Agregar SweetAlert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        /* Estilos claros por defecto */
    /* Estilos generales del body, aplicando una fuente moderna y colores suaves para mejorar la legibilidad */
body {
    font-family: "system-ui", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background-color: #F5F5F5;
    color: #333;
    transition: background-color 0.6s, color 0.6s;
    /* Fuente del sistema para garantizar coherencia en dispositivos Apple y Windows.
    Fondo claro y transición suave entre modos de fondo. */
}
.form-control, .dropzone {
    background-color: #ffffff;
    color: #000000;
    border: 1px solid #c5cad3;
    transition: background-color 0.3s, color 0.3s;
    /* Campos de formularios y zona de arrastre con fondo claro y bordes suaves.
    La transición proporciona una experiencia visual fluida cuando cambia el color. */
}
.progress-bar {
    background-color: #4caf50;
    /* Barra de progreso en verde para indicar éxito o avance positivo */
}
.progress-bar {
    font-size: 1rem;
    font-weight: bold;
    color: white;
    text-align: center;
    transition: width 2.4s ease;
    /* Tamaño de fuente claro y centrado para una visualización legible de la barra de progreso */
}

.progress {
    height: 30px;
    /* Ajuste de la altura de la barra de progreso para que sea visualmente prominente */
}
.btn {
    margin-bottom: 15px;
    padding: 10px 20px;
    border-radius: 8px;
    /* Botones con un diseño espacioso y esquinas redondeadas para una estética moderna */
}
.btn-primary {
    background-color: #007AFF; /* Azul típico de Apple para reflejar diseño moderno */
    border: none;
    border-radius: 12px;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    transition: background-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
    /* Efecto de sombra suave para darle un estilo tridimensional y efecto hover elegante */
}
.btn-primary:hover {
    background-color: #005BB5;
    box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.15);
    /* Cambio de color al pasar el ratón para indicar interactividad */
}
body.dark-mode {
    background-color: #121212;
    color: #e0e0e0;
    /* Modo oscuro con fondo oscuro y texto claro para mejorar la lectura en entornos de baja luz */
}
h1 {
    font-size: 2.5rem;
    font-weight: 500;
    /* Título principal de la página grande y claro, con un peso medio para resaltar su importancia */
}
.form-control, .dropzone, .btn-primary {
    border-radius: 16px;
    /* Esquinas redondeadas para un diseño más suave y amigable */
}

body.dark-mode .form-control,
body.dark-mode .dropzone {
    background-color: #333;
    color: #e0e0e0;
    border-color: #444;
    /* En modo oscuro, los formularios y áreas de drop tienen colores más oscuros para reducir el brillo */
}

body.dark-mode .progress-bar {
    background-color: #1db954;
    /* En modo oscuro, la barra de progreso se muestra en verde vibrante para destacar */
}

body.dark-mode .btn-primary {
    background-color: #1a73e8;
    border-color: #1a73e8;
    /* Botones en modo oscuro con un color azul claro para una mejor visibilidad */
}

/* Estilos del switch de modo claro/oscuro */
.toggle-container {
    position: relative;
    width: 61px;
    height: 30px;
    background-color: #87CEEB;
    border: 1.4px solid #6c757d;
    border-radius: 30px;
    cursor: pointer;
    display: inline-block;
    box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.15);
    transition: background-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
    background-image:
        linear-gradient(to bottom, #87CEEB 40%, #76d7fa 70%, #07f1aa 90%),
        radial-gradient(circle at 50% 90%, rgba(255, 223, 0, 0.8) 15%, transparent 35%);
    /* Botón para alternar entre modos oscuro y claro, con efectos visuales elegantes */
}
.form-label, .btn-primary {
    letter-spacing: 0.5px; /* Pequeño espaciado entre letras para mejorar la legibilidad */
}
.container {
    max-width: 700px;
    margin: 0 auto;
    /* Limitar el ancho máximo del contenedor y centrarlo en la página */
}

.toggle-btn {
    position: absolute;
    top: 50%;
    left: -1px;
    width: 27px;
    height: 26.5px;
    background-color: #FFFFFF;
    border: 1.5px solid #6c757d;
    border-radius: 50%;
    box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.2);
    transform: translateY(-50%);
    transition: transform 1s cubic-bezier(0.25, 0.1, 0.79, 0.27), background-color 1s ease, border-color 1s ease;
    /* Botón deslizante para alternar entre modos, con animación fluida y transición suave */
}

body.dark-mode .toggle-container {
    background-color: #070797;
    border-color: #d3d3d3;
    background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="white" /><circle cx="50" cy="30" r="3" fill="white" /><circle cx="80" cy="20" r="2" fill="white" /><circle cx="40" cy="70" r="1.5" fill="white" /><circle cx="70" cy="80" r="2" fill="white" /></svg>');
    /* Fondo estrellado para el modo oscuro, imitando un cielo nocturno */
}

body.dark-mode .toggle-btn {
    transform: translate(32px, -50%);
    background-color: #d3d3d3;
    border-color: #50b8ed;
    /* Botón de modo oscuro deslizado hacia la derecha con un color más suave */
}

.toggle-container .icon {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    font-size: 18px;
    transition: opacity 2s ease, transform 2s ease;
    /* Iconos de sol y luna con animación para suavizar la transición de modos */
}

.icon-sun {
    left: 8px;
    color: #f39c12;
    opacity: 1;
    left: 4px;
    transition: opacity 2s ease, transform 2s ease;
    /* Icono de sol para modo claro */
}

.icon-moon {
    right: 8px;
    color: #3498db;
    opacity: 0;
    left: 37px;
    transition: opacity 2s ease, transform 2s ease;
    /* Icono de luna para modo oscuro */
}

body.dark-mode .icon-sun {
    opacity: 0;
    transform: translateY(-50%) scale(0.8);
    /* Sol oculto en modo oscuro */
}

body.dark-mode .icon-moon {
    opacity: 1;
    transform: translateY(-50%) scale(1);
    /* Luna visible en modo oscuro */
}

/* Estilos generales para la zona de subida de archivos */
.upload-container {
    max-width: 600px;
    margin: 20px auto;
    /* Contenedor centrado para la zona de subida, con un tamaño adecuado */
}

.dropzone {
    border: 2px dashed #007AFF;
    padding: 20px;
    text-align: center;
    cursor: pointer;
    position: relative;
    transition: border-color 0.3s;
    /* Zona de drop con borde azul de Apple y transiciones suaves para una mejor UX */
}

.dropzone-text {
    font-size: 1rem;
    /* Texto de la zona de drop ajustado a un tamaño legible */
}

.sub-text {
    font-size: 0.8rem;
    color: gray;
    display: block;
    /* Texto de ayuda con tamaño reducido y color gris */
}

.file-list {
    margin-top: 20px;
    /* Lista de archivos subidos con separación superior */
}

.file-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    border: 1px solid #dedede;
    margin-bottom: 10px;
    border-radius: 8px;
    position: relative;
    /* Estilos para los elementos de archivo subidos: diseño limpio y borde suave */
}

.file-item.success {
    border-left: 5px solid green;
    /* Bordes verdes para archivos subidos exitosamente */
}

.file-item.error {
    border-left: 5px solid red;
    /* Bordes rojos para archivos con errores */
}

.file-info {
    display: flex;
    align-items: center;
    /* Diseño en fila para mostrar la información de los archivos */
}

.file-name {
    font-size: 1rem;
    margin-left: 10px;
    /* Nombre del archivo con margen para separar del ícono */
}

.file-size {
    font-size: 0.9rem;
    color: gray;
    /* Tamaño del archivo en gris para ser menos prominente que el nombre */
}

.file-status {
    font-size: 0.8rem;
    margin-left: 10px;
    color: red;
    /* Estado del archivo en rojo para errores */
}

.delete-btn {
    background-color: transparent;
    border: none;
    cursor: pointer;
    color: #ff0000;
    font-size: 1.2rem;
    /* Botón de eliminación de archivos, estilo limpio sin fondo, pero con ícono rojo */
}

.delete-btn:hover {
    color: #d00000;
    /* Cambio de color al pasar el ratón para indicar acción */
}

.error-message {
    color: red;
    font-size: 0.9rem;
    margin-top: 5px;
    opacity: 0;
    transition: opacity 0.6s ease-in-out;
    /* Mensaje de error con animación suave al mostrarse */
}

.show-error {
    opacity: 1;
    /* Mostrar error con animación */
}

.progress {
    height: 30px;
    /* Ajustar altura de la barra de progreso para hacerla más visible */
}

.progress-bar {
    background-color: #007AFF;
    font-size: 1rem;
    font-weight: bold;
    color: white;
    text-align: center;
    transition: width 2.4s ease;
    /* Barra de progreso con colores primarios de Apple y transiciones suaves */
}

input.invalid {
    background-color: rgba(255, 0, 0, 0.1);
    /* Campo de entrada con fondo rojo claro para indicar error */
}

/* Previsualización de archivos cargados */
#previews img {
    max-width: 100px;
    margin: 10px;
    /* Estilo de imagen de vista previa, con tamaño limitado */
}

/* Breadcrumbs (Migas de pan) */
.breadcrumb {
    background-color: transparent;
    /* Fondo transparente para las migas de pan */
}

.custom-checkbox {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-color: #f3f4f6;
    border: 1px solid #d1d5db;
    appearance: none;
    cursor: pointer;
    transition: all 0.3s ease;
    /* Checkbox personalizado con un diseño circular, estilo limpio y transiciones suaves */
}

.custom-checkbox:checked {
    background-color: #007AFF;
    border-color: #007AFF;
    box-shadow: 0 0 5px rgba(0, 122, 255, 0.5);
    /* Estilo del checkbox cuando está seleccionado: azul con sombra */
}

.custom-checkbox:disabled {
    border-color: #e5e7eb;
    cursor: not-allowed;
    /* Checkbox deshabilitado: sin interacción posible */
}

.custom-checkbox:hover {
    box-shadow: 0 0 5px rgba(0, 122, 255, 0.3);
    /* Efecto de sombra al pasar el ratón para resaltar el checkbox */
}

    </style>
</head>
<body>
   <div class="container mt-4">

    <!-- Título principal de la página -->
    <h1 class="text-center mb-4">Subir Documentos y Credenciales</h1>

    <!-- Botón de modo oscuro/claro con animación, permite alternar entre modos -->
    <div class="text-center mb-4">
        <div class="toggle-container" id="darkModeToggle" aria-label="Toggle dark mode" role="button" tabindex="0">
            <div class="toggle-btn"></div>
            <!-- Icono del sol para el modo claro -->
            <i class="bi bi-sun icon icon-sun" aria-hidden="true"></i>
            <!-- Icono de la luna para el modo oscuro -->
            <i class="bi bi-moon icon icon-moon" aria-hidden="true"></i>
        </div>
    </div>

    <!-- Sección con botones para descargar las plantillas de Word y Excel -->
    <div class="text-center mb-4">
        <!-- Botón para descargar la plantilla de Word -->
        <a href="/static/files/plantilla_notas.docx" class="btn btn-secondary me-2" download="PlantillaWord.docx">
            <i class="bi bi-file-earmark-word"></i> Descargar Plantilla de Word
        </a>
        <!-- Botón para descargar un ejemplo de Excel -->
        <a href="/static/files/notas_alumnos.xlsx" class="btn btn-secondary" download="EjemploExcel.xlsx">
            <i class="bi bi-file-earmark-excel"></i> Descargar Ejemplo de Excel
        </a>
    </div>

    <!-- Formulario para enviar correos, inicialmente oculto, se mostrará después de subir los archivos -->
    <form id="emailForm" action="/enviar_correos" method="POST" class="mt-4" style="display:none;">
        <div class="mb-3">
            <label for="email" class="form-label">Correo electrónico:</label>
            <!-- Campo de entrada para el correo del usuario -->
            <input type="email" id="email" name="email" class="form-control" required placeholder="Correo">
        </div>

        <div class="mb-3">
            <label for="password" class="form-label">Contraseña:</label>
            <!-- Campo de entrada para la contraseña del usuario -->
            <input type="password" id="password" name="password" class="form-control" required placeholder="Contraseña">
        </div>

        <!-- Botón para enviar correos a los estudiantes -->
        <button type="submit" class="btn btn-success w-100">Enviar Correos</button>
    </form>

    <!-- Botón para descargar el backup de informes, deshabilitado hasta que se carguen archivos -->
    <div class="text-center mt-4">
        <a href="/descargar_backup" id="backupButton" class="btn btn-secondary disabled" style="pointer-events: none;">
            <i class="bi bi-file-zip"></i> Descargar Backup de Informes
        </a>
    </div>

    <!-- Barra de progreso general para mostrar el estado de la carga de archivos -->
    <div class="progress mt-4">
        <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" style="width: 0%;">0%</div>
    </div>

    <!-- Formulario para la subida de archivos -->
    <form id="uploadForm" action="/procesar_archivos" method="POST" enctype="multipart/form-data" novalidate class="mt-4">
        <!-- Sección para cargar el archivo de Excel -->
        <div class="mb-3">
            <label for="archivo_1" class="form-label">Subir documento 1 (Excel):</label>
            <!-- Zona de arrastre y selección para el archivo Excel -->
            <div class="dropzone border" id="dropzoneExcel" tabindex="0" aria-label="Zona de subida de archivo Excel">
                <input type="file" id="archivo_1" name="archivo_1" class="form-control d-none" required accept=".xlsx">
                <p class="text-center dropzone-text">Arrastra y suelta el archivo aquí o haz clic para seleccionarlo</p>
            </div>
            <!-- Lista de archivos seleccionados -->
            <div id="fileListExcel" class="file-list"></div>
        </div>

        <!-- Sección para cargar el archivo de Word -->
        <div class="mb-3">
            <label for="archivo_2" class="form-label">Subir documento 2 (Word):</label>
            <!-- Zona de arrastre y selección para el archivo Word -->
            <div class="dropzone border" id="dropzoneWord" tabindex="0" aria-label="Zona de subida de archivo Word">
                <input type="file" id="archivo_2" name="archivo_2" class="form-control d-none" required accept=".docx">
                <p class="text-center dropzone-text">Arrastra y suelta el archivo aquí o haz clic para seleccionarlo</p>
            </div>
            <!-- Lista de archivos seleccionados -->
            <div id="fileListWord" class="file-list"></div>
        </div>

        <!-- Botón para iniciar la subida de archivos -->
        <button type="submit" class="btn btn-primary w-100">Subir Archivos</button>
    </form>

    <!-- Barra de progreso para mostrar el estado del envío de correos, oculta por defecto -->
    <div class="progress mt-4" id="emailProgressSection" style="display: none;">
        <div id="emailProgressBar" class="progress-bar progress-bar-striped progress-bar-animated" style="width: 0%;">
            0%
        </div>
    </div>
</div>

    <!-- Bootstrap JS y dependencias -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>

<script>
// Selección de elementos
const toggle = document.getElementById('darkModeToggle');
const body = document.body;

// Alternar modo oscuro/claro
toggle.addEventListener('click', () => {
    body.classList.toggle('dark-mode');
    localStorage.setItem('dark-mode', body.classList.contains('dark-mode'));
});

const dropzoneExcel = document.getElementById('dropzoneExcel');
const fileInputExcel = document.getElementById('archivo_1');
const dropzoneWord = document.getElementById('dropzoneWord');
const fileInputWord = document.getElementById('archivo_2');
const progressBar = document.getElementById('progress-bar');
const backupButton = document.getElementById('backupButton');
const uploadForm = document.getElementById('uploadForm');
const emailForm = document.getElementById('emailForm');

// Para mostrar la lista de archivos en el DOM
const fileListExcel = document.getElementById('fileListExcel');
const fileListWord = document.getElementById('fileListWord');

// Función para resetear zonas de drop
function resetDropzones() {
    resetFileInput(dropzoneExcel, fileInputExcel, fileListExcel);
    resetFileInput(dropzoneWord, fileInputWord, fileListWord);
}

function resetFileInput(dropzone, fileInput, fileList) {
    fileInput.value = ''; // Resetear el input de archivo
    fileList.innerHTML = ''; // Vaciar la lista de archivos
    const dropzoneText = dropzone.querySelector('.dropzone-text');
    dropzoneText.style.display = 'block'; // Mostrar de nuevo la zona de arrastre
    dropzone.style.display = 'block'; // Mostrar la zona de drop de nuevo
}

// Función para manejar los archivos seleccionados
function handleFileInput(fileInput, dropzone, fileList, fileType) {
    const files = fileInput.files;
    fileList.innerHTML = ''; // Limpiar la lista de archivos previos

    for (let file of files) {
        const fileSizeMB = (file.size / (1024 * 1024)).toFixed(2); // Tamaño en MB
        const fileItem = document.createElement('div');
        fileItem.classList.add('file-item');

        // Verificar tipo y tamaño de archivo
        const validTypes = fileType === 'excel'
            ? ['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet']
            : ['application/vnd.openxmlformats-officedocument.wordprocessingml.document'];

        if (!validTypes.includes(file.type)) {
            fileItem.classList.add('error');
            fileItem.innerHTML = `
    <div class="file-info">
        <i class="bi bi-file-earmark-fill"></i>
        <span class="file-name">${file.name}</span>
        <span class="file-size">${fileSizeMB} MB</span>
    </div>
    <button class="delete-btn" type="button" onclick="deleteFile(this, '${file.name}')">&#10006;</button>
`;
        } else if (file.size > 25 * 1024 * 1024) {
            fileItem.classList.add('error');
            fileItem.innerHTML = `
                <div class="file-info">
                    <i class="bi bi-file-earmark-fill"></i>
                    <span class="file-name">${file.name}</span>
                    <span class="file-size">${fileSizeMB} MB</span>
                    <span class="file-status text-danger">El archivo es demasiado grande (máx. 25 MB)</span>
                </div>
                <button class="delete-btn" type="button" onclick="deleteFile(this, '${file.name}', fileList)">&#10006;</button>
            `;
        } else {
            fileItem.classList.add('success');
            fileItem.innerHTML = `
                <div class="file-info">
                    <i class="bi bi-file-earmark-fill"></i>
                    <span class="file-name">${file.name}</span>
                    <span class="file-size">${fileSizeMB} MB</span>
                </div>
                <button class="delete-btn" type="button" onclick="deleteFile(this, '${file.name}', fileList)">&#10006;</button>
            `;
            dropzone.style.display = 'none'; // Ocultar la zona de arrastre cuando se carga correctamente un archivo
        }

        fileList.appendChild(fileItem);
    }
}

// Función para eliminar archivos de la lista y restablecer la zona de drop
function deleteFile(button, fileName) {
    const fileItem = button.closest('.file-item');

    // Eliminar del DOM
    fileItem.remove();

    // Enviar solicitud para eliminar del servidor
    fetch('/eliminar_archivo', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: `archivo=${encodeURIComponent(fileName)}`
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            console.log('Archivo eliminado correctamente');
        } else {
            console.error('Error al eliminar el archivo:', data.message);
        }
    })
    .catch(error => console.error('Error en la solicitud:', error));
}

// Función para resetear la lista de archivos tras eliminar
function resetFileList(fileList) {
    fileList.innerHTML = ''; // Limpiar la lista de archivos en el DOM
    resetDropzones(); // Restablecer las zonas de drop
}

// Configurar zonas de drop
function setupDropzone(dropzone, fileInput, fileList, fileType) {
    dropzone.addEventListener('dragover', e => {
        e.preventDefault();
        dropzone.classList.add('dragover');
    });

    dropzone.addEventListener('dragleave', () => dropzone.classList.remove('dragover'));

    dropzone.addEventListener('drop', e => {
        e.preventDefault();
        dropzone.classList.remove('dragover');
        const files = e.dataTransfer.files;
        fileInput.files = files;
        handleFileInput(fileInput, dropzone, fileList, fileType);
    });

    dropzone.addEventListener('click', () => fileInput.click());
}

setupDropzone(dropzoneExcel, fileInputExcel, fileListExcel, 'excel');
setupDropzone(dropzoneWord, fileInputWord, fileListWord, 'word');

// Manejador del formulario de subida
uploadForm.addEventListener('submit', function (e) {
    e.preventDefault();
    handleFormSubmit('/procesar_archivos', uploadForm, updateUIAfterUpload);
});

function handleFormSubmit(url, form, callback) {
    const formData = new FormData(form);
    const xhr = new XMLHttpRequest();
    xhr.open('POST', url, true);

    Swal.fire({
        title: 'Subiendo...',
        html: 'Por favor, espera.',
        allowOutsideClick: false,
        didOpen: () => {
            Swal.showLoading();
        }
    });

    xhr.upload.onprogress = function (e) {
        if (e.lengthComputable) {
            const percentComplete = (e.loaded / e.total) * 100;
            progressBar.style.width = `${percentComplete}%`;
            progressBar.textContent = `${Math.round(percentComplete)}%`;
        }
    };

    xhr.onload = function () {
        if (xhr.status === 200) {
            const response = JSON.parse(xhr.responseText);
            if (response.success) {
                Swal.fire('¡Éxito!', 'Tus archivos han sido procesados correctamente.', 'success');
                callback();
            } else {
                handleError(response.message || 'Ocurrió un problema al procesar los archivos.');
            }
        } else {
            handleError('Error en el servidor.');
        }
    };

    xhr.onerror = function () {
        handleError('Ocurrió un problema en la subida.');
    };

    xhr.send(formData);
}

function updateUIAfterUpload() {
    backupButton.classList.remove('disabled');
    backupButton.style.pointerEvents = 'auto';
    progressBar.style.width = '0%';
    progressBar.textContent = '0%';
    emailForm.style.display = 'block'; // Mostrar formulario de envío de correo
}

emailForm.addEventListener('submit', function (e) {
    e.preventDefault();
    handleFormSubmit('/enviar_correos', emailForm, resetUI);
});

function resetUI() {
    Swal.fire({
        title: '¡Enviado!',
        html: 'Tus correos fueron enviados con éxito.',
        icon: 'success',
        showConfirmButton: false,
        timer: 3000,
        willClose: () => {
            confettiAnimation();
        }
    });
    emailForm.style.display = 'none';
    resetDropzones();
}

function confettiAnimation() {
    const duration = 3 * 1000;
    const end = Date.now() + duration;

    (function frame() {
        confetti({
            particleCount: 5,
            angle: 60,
            spread: 55,
            origin: { x: 0 }
        });
        confetti({
            particleCount: 5,
            angle: 120,
            spread: 55,
            origin: { x: 1 }
        });

        if (Date.now() < end) {
            requestAnimationFrame(frame);
        }
    }());
}

function handleError(message) {
    Swal.fire('Error', message, 'error');
}

document.addEventListener('DOMContentLoaded', () => {
    if (localStorage.getItem('dark-mode') === 'true') {
        body.classList.add('dark-mode');
    }
});


</script>


</body>
</html>
